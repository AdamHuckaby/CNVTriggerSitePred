#subset hairpins and write bedfiles
#Read shuffled and normal data in
input_01_data <- read.table("input_01_data.bed", header=FALSE)
input_02_data <- read.table("input_02_data.bed", header=FALSE)
input_03_data <- read.table("input_03_data.bed", header=FALSE)
input_04_data <- read.table("input_04_data.bed", header=FALSE)
input_05_data <- read.table("input_05_data.bed", header=FALSE)
input_06_data <- read.table("input_06_data.bed", header=FALSE)
input_07_data <- read.table("input_07_data.bed", header=FALSE)
input_08_data <- read.table("input_08_data.bed", header=FALSE)
input_09_data <- read.table("input_09_data.bed", header=FALSE)
input_10_data <- read.table("input_10_data.bed", header=FALSE)
input_11_data <- read.table("input_11_data.bed", header=FALSE)
input_12_data <- read.table("input_12_data.bed", header=FALSE)
input_13_data <- read.table("input_13_data.bed", header=FALSE)
input_14_data <- read.table("input_14_data.bed", header=FALSE)

input_01_data_shuffled <- read.table("input_01_data_shuffled.bed", header=FALSE)
input_02_data_shuffled <- read.table("input_02_data_shuffled.bed", header=FALSE)
input_03_data_shuffled <- read.table("input_03_data_shuffled.bed", header=FALSE)
input_04_data_shuffled <- read.table("input_04_data_shuffled.bed", header=FALSE)
input_05_data_shuffled <- read.table("input_05_data_shuffled.bed", header=FALSE)
input_06_data_shuffled <- read.table("input_06_data_shuffled.bed", header=FALSE)
input_07_data_shuffled <- read.table("input_07_data_shuffled.bed", header=FALSE)
input_08_data_shuffled <- read.table("input_08_data_shuffled.bed", header=FALSE)
input_09_data_shuffled <- read.table("input_09_data_shuffled.bed", header=FALSE)
input_10_data_shuffled <- read.table("input_10_data_shuffled.bed", header=FALSE)
input_11_data_shuffled <- read.table("input_11_data_shuffled.bed", header=FALSE)
input_12_data_shuffled <- read.table("input_12_data_shuffled.bed", header=FALSE)
input_13_data_shuffled <- read.table("input_13_data_shuffled.bed", header=FALSE)
input_14_data_shuffled <- read.table("input_14_data_shuffled.bed", header=FALSE)

#Create single files to write and do calculations
input_total_data <- rbind(input_01_data, input_02_data, input_03_data, input_04_data, input_05_data, input_06_data, input_07_data, input_08_data, input_09_data, input_10_data, input_11_data, input_12_data, input_13_data, input_14_data)
input_total_data_shuffled <- rbind(input_01_data_shuffled, input_02_data_shuffled, input_03_data_shuffled, input_04_data_shuffled, input_05_data_shuffled, input_06_data_shuffled, input_07_data_shuffled, input_08_data_shuffled, input_09_data_shuffled, input_10_data_shuffled, input_11_data_shuffled, input_12_data_shuffled, input_13_data_shuffled, input_14_data_shuffled)

#subset hairpins and write bedfiles
cutoff <- quantile(input_total_data_shuffled$V5, significant)
input_01_sig <- subset(input_01_data, V5 <= cutoff)
input_02_sig <- subset(input_02_data, V5 <= cutoff)
input_03_sig <- subset(input_03_data, V5 <= cutoff)
input_04_sig <- subset(input_04_data, V5 <= cutoff)
input_05_sig <- subset(input_05_data, V5 <= cutoff)
input_06_sig <- subset(input_06_data, V5 <= cutoff)
input_07_sig <- subset(input_07_data, V5 <= cutoff)
input_08_sig <- subset(input_08_data, V5 <= cutoff)
input_09_sig <- subset(input_09_data, V5 <= cutoff)
input_10_sig <- subset(input_10_data, V5 <= cutoff)
input_11_sig <- subset(input_11_data, V5 <= cutoff)
input_12_sig <- subset(input_12_data, V5 <= cutoff)
input_13_sig <- subset(input_13_data, V5 <= cutoff)
input_14_sig <- subset(input_14_data, V5 <= cutoff)
input_total_sig <- rbind(input_01_sig, input_02_sig, input_03_sig, input_04_sig, input_05_sig, input_06_sig, input_07_sig, input_08_sig, input_09_sig, input_10_sig, input_11_sig, input_12_sig, input_13_sig, input_14_sig)
write.table(input_01_sig, file = "input_01_sig.bed", quote=FALSE, sep='\t', col.names=FALSE, row.names=FALSE)
write.table(input_02_sig, file = "input_02_sig.bed", quote=FALSE, sep='\t', col.names=FALSE, row.names=FALSE)
write.table(input_03_sig, file = "input_03_sig.bed", quote=FALSE, sep='\t', col.names=FALSE, row.names=FALSE)
write.table(input_04_sig, file = "input_04_sig.bed", quote=FALSE, sep='\t', col.names=FALSE, row.names=FALSE)
write.table(input_05_sig, file = "input_05_sig.bed", quote=FALSE, sep='\t', col.names=FALSE, row.names=FALSE)
write.table(input_06_sig, file = "input_06_sig.bed", quote=FALSE, sep='\t', col.names=FALSE, row.names=FALSE)
write.table(input_07_sig, file = "input_07_sig.bed", quote=FALSE, sep='\t', col.names=FALSE, row.names=FALSE)
write.table(input_08_sig, file = "input_08_sig.bed", quote=FALSE, sep='\t', col.names=FALSE, row.names=FALSE)
write.table(input_09_sig, file = "input_09_sig.bed", quote=FALSE, sep='\t', col.names=FALSE, row.names=FALSE)
write.table(input_10_sig, file = "input_10_sig.bed", quote=FALSE, sep='\t', col.names=FALSE, row.names=FALSE)
write.table(input_11_sig, file = "input_11_sig.bed", quote=FALSE, sep='\t', col.names=FALSE, row.names=FALSE)
write.table(input_12_sig, file = "input_12_sig.bed", quote=FALSE, sep='\t', col.names=FALSE, row.names=FALSE)
write.table(input_13_sig, file = "input_13_sig.bed", quote=FALSE, sep='\t', col.names=FALSE, row.names=FALSE)
write.table(input_14_sig, file = "input_14_sig.bed", quote=FALSE, sep='\t', col.names=FALSE, row.names=FALSE)
write.table(input_total_sig, file = "input_total_sig.bed", quote=FALSE, sep='\t', col.names=FALSE, row.names=FALSE)
write.table(input_total_data, file = "input_total_data.bed", quote=FALSE, sep='\t', col.names=FALSE, row.names=FALSE)
write.table(input_total_data_shuffled, file = "input_total_data_shuffled.bed", quote=FALSE, sep='\t', col.names=FALSE, row.names=FALSE)